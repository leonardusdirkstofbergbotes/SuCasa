<h1>Categories</h1>

<div>
    <app-button (click)="categoryModal.open()">Create new category</app-button>
</div>

<app-modal [loading]="fetchingFormInfo" (closed)="resetForm()" [title]="editCategoryId != null ? 'Update category' : 'Create new category'" #categoryModal>
    <div content>
        <app-add-picture [picturePreviewUrl]="categoryForm.controls['imagePath'].value" (fileChanged)="pictureChanged($event)"></app-add-picture>
        <app-input label="Name" [control]="categoryForm.controls['name']" type="text"></app-input>
        <app-input label="Description" [control]="categoryForm.controls['description']" rows="4" type="textarea"></app-input>
        <app-toggle-button label="Promote" [control]="categoryForm.controls['promote']"></app-toggle-button>
    </div>
    <div class="footer">
        <app-button (click)="categoryModal.close()" type="outline-primary">Cancel</app-button>
        <app-button [loading]="processingInput" *ngIf="editCategoryId == null" (click)="createNewCategory()">Create</app-button>
        <app-button [loading]="processingInput" *ngIf="editCategoryId != null" (click)="updateCategory()">Update</app-button>
    </div>
</app-modal>

<div class="grid grid-cols-2 gap-6 categories">
    <div *ngFor="let category of categories" class="item" (click)="editCategory(category.uid)">
        <img [src]="category.imagePath" alt="image of category" />
        <div class="flex flex-col p-1 mt-4">
            <span class="title">{{category.name}}</span>
            <small class="mt-2 description">{{category.description}}</small>
        </div>
    </div>
    
</div>
